!function(){"use strict";function n(){function n(n,s,i){function u(n){return h[n]}function c(e){e={url:e.url,method:e.method.toUpperCase(),data:e.data,headers:e.headers},("DELETE"==e.method||"POST"==e.method||"PUT"==e.method)&&(e.$$hashKey=Math.floor(1e9*Math.random()),o.push(e),window.sessionStorage.setItem("sync:queues",JSON.stringify(o)),n.$broadcast("sync:addQueue",e))}function a(){return null===JSON.parse(window.sessionStorage.getItem("sync:queues"))?window.sessionStorage.setItem("sync:queues",JSON.stringify(o)):o=JSON.parse(window.sessionStorage.getItem("sync:queues")),o}function f(){i.isOnline()&&0!==o.length&&angular.forEach(o,function(n,e){l(n,e)})}function d(){n.$on("sync:online",function(){r||f(),r=!0}),n.$on("sync:offline",function(){r=!1})}function l(n,e){if(i.isOnline()){var t=new XMLHttpRequest;t.open(n.method,n.url);var o=[];angular.forEach(n.headers,function(n,e){t.setRequestHeader(e,n),o.push(e)}),s.all(o).then(function(){t.send(JSON.stringify(n.data))},function(n){deferred.reject(n)}),t.onload=function(){y(e)}}}function y(e){n.$broadcast("sync:delQueue",o[e]),o.splice(e,1),window.sessionStorage.setItem("sync:queues",JSON.stringify(o))}function g(n){var e="urlRoot";return""===h[e]||n.url.indexOf(h[e])>=0}var h=angular.extend({},e,t),$={getConfig:u,addQueue:c,getQueues:a,sync:f,init:d,isUrlRoot:g};return $}var e={urlRoot:""},t={},o=[],r=!0;this.options=function(n){angular.extend(t,n)},this.$get=n,n.$inject=["$rootScope","$q","SyncOnline"]}function e(n,e,t,o){function r(n){return o.isOnline()&&e.isUrlRoot(n)&&e.addQueue(n),n}function s(e){return t.$broadcast(e.status&&e.status<12e3?"sync:online":"sync:offline"),n.reject(e)}function i(n){return t.$broadcast("sync:online"),n}function u(e){return t.$broadcast((e.status&&e.status<12e3,"sync:offline")),n.reject(e)}var c={request:r,requestError:s,response:i,responseError:u};return c}function t(n){function e(){return t.online}var t={online:n.navigator.onLine,isOnline:e};return t}var o=angular.module("ngSync",["ng"]);o.provider("$sync",n),o.factory("SyncOnline",t),o.factory("SyncInterceptor",e),n.$inject=[],e.$inject=["$q","$sync","$rootScope","SyncOnline"],t.$inject=["$window"]}(this);