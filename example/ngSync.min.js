!function(){"use strict";function n(){function n(n,r){function i(n){return g[n]}function u(e){("DELETE"==e.method||"POST"==e.method||"PUT"==e.method)&&(e.$$hashKey=Math.floor(1e9*Math.random()),o.push(e),window.sessionStorage.setItem("sync:queues",JSON.stringify(o)),n.$broadcast("sync:addQueue",e))}function c(){return null===JSON.parse(window.sessionStorage.getItem("sync:queues"))?window.sessionStorage.setItem("sync:queues",JSON.stringify(o)):o=JSON.parse(window.sessionStorage.getItem("sync:queues")),o}function a(){r.isOnline()&&0!==o.length&&angular.forEach(o,function(n,e){d(n,e)})}function f(){n.$on("sync:online",function(){s||a(),s=!0}),n.$on("sync:offline",function(){s=!1})}function d(n,e){if(r.isOnline()){var t=new XMLHttpRequest;t.onload=function(){l(e)},t.open(n.method,n.url),n.data?t.send(n.data):t.send()}}function l(e){n.$broadcast("sync:delQueue",o[e]),o.splice(e,1),window.sessionStorage.setItem("sync:queues",JSON.stringify(o))}function y(n){var e="urlRoot";return""===g[e]||n.url.indexOf(g[e])>=0}var g=angular.extend({},e,t),$={getConfig:i,addQueue:u,getQueues:c,sync:a,init:f,isUrlRoot:y};return $}var e={urlRoot:""},t={},o=[],s=!0;this.options=function(n){angular.extend(t,n)},this.$get=n,n.$inject=["$rootScope","SyncOnline"]}function e(n,e,t,o){function s(n){return o.isOnline()&&e.isUrlRoot(n)&&e.addQueue({url:n.url,method:n.method.toUpperCase(),data:n.data}),n}function r(e){return t.$broadcast(e.status&&e.status<12e3?"sync:online":"sync:offline"),n.reject(e)}function i(n){return t.$broadcast("sync:online"),n}function u(e){return t.$broadcast((e.status&&e.status<12e3,"sync:offline")),n.reject(e)}var c={request:s,requestError:r,response:i,responseError:u};return c}function t(n){function e(){return t.online}var t={online:n.navigator.onLine,isOnline:e};return t}var o=angular.module("ngSync",["ng"]);o.provider("$sync",n),o.factory("SyncOnline",t),o.factory("SyncInterceptor",e),n.$inject=[],e.$inject=["$q","$sync","$rootScope","SyncOnline"],t.$inject=["$window"]}(this);